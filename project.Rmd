â€ ---
title: "STAT331 Project"
author: "Sijie Jin, Raymond Tan, Yinong Wang"
date: '2018-11-14'
output: 
  pdf_document:
    number_sections: true
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Summary

# Model Selection

## Pre-fitting data diagnostic

```{r}
# read in data
births.raw = read.csv("chds_births.csv")
```

### Summary of Data

```{r}
head(births.raw)
summary(births.raw)

proportion <- sapply(births.raw, function(x) { sum(is.na(x))*100/nrow(births.raw) })
proportion

births.reduced <- births.raw[, !names(births.raw) %in% c('fht', 'fwt')]

births.mice <- mice(births.reduced)
births.clean <- complete(births.mice)
```

### NA's and $\pm$Inf's

```{r}

```

## Automated Model Selection

### Forward Model Selection

```{r}

```

### Backward Model Selection

```{r}

```

### Stepwise Model Selection

```{r}

```

## Manual Model Selection

### Cross Validation

```{r}

```

### PRESS Statistics

### Akaike Information Criterion

## Conclusion

# Model Diagnostics

```{r}
#anova(M1, M2)

M0 <- lm(wt ~ 1, data = births.clean)
Mfull <- lm(wt ~ (.)^2, data = births.clean)
Mstart <- lm(wt ~ gestation + meth + mage + mwt + smoke + number, data = births.clean)

# forward
M1 <- step(object = M0,
             scope = list(lower = M0, upper = Mfull),
             direction = "forward",
             trace = FALSE)


# stepward
M2 <- step(object = Mfull, 
              scope = list(lower = M0, upper = Mfull),
              direction = "both", 
              trace = TRUE)

cex <- .8

# studendized residual for M1:



# standardized residual for M1:

res1 <- residuals(M1) 
X1 <- model.matrix(M1) # design matrix
H1 <- X1 %*% solve(crossprod(X1), t(X1)) # Hat matrix
h1 <- diag(H1)
range(h1 - hatvalues(M1))
sigma.hat1 <- sigma(M1)
par(mar = c(4,4,.1,.1))
hist(res1/sigma.hat1, breaks = 50, freq = FALSE, cex.axis = cex,
xlab = "Standardized Residual for M1", main = "")
curve(dnorm(x), col = "red", add = TRUE)

# standardized residual for M2

res2 <- residuals(M2) 
X2 <- model.matrix(M2) # design matrix
H2 <- X2 %*% solve(crossprod(X2), t(X2)) # Hat matrix
h2 <- diag(H2)
range(h2 - hatvalues(M2))
sigma.hat2 <- sigma(M2)
par(mar = c(4,4,.1,.1))
hist(res2/sigma.hat2, breaks = 50, freq = FALSE, cex.axis = cex,
xlab = "Standardized Residual for M2", main = "")
curve(dnorm(x), col = "red", add = TRUE)


```

## Linear Model Assumptions

## Colinearity

## Outliers

# Conclusions

